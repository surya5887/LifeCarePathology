{% extends 'admin/admin_base.html' %}
{% block title %}Dashboard{% endblock %}
{% block page_title %}Dashboard{% endblock %}

{% block content %}
<!-- ═══ Create Report Hero CTA ═══ -->
<a href="{{ url_for('admin.create_report') }}" class="create-report-hero" style="
    display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap;
    background: linear-gradient(135deg, #0A6EBD, #2563EB, #7C3AED);
    border-radius: 16px; padding: 24px 32px; margin-bottom: 24px;
    text-decoration: none; color: #fff; position: relative; overflow: hidden;
    box-shadow: 0 8px 32px rgba(37,99,235,0.35); transition: transform .2s, box-shadow .2s;">
    <div style="z-index:1;">
        <div style="font-size:12px; text-transform:uppercase; letter-spacing:2px; opacity:0.8; margin-bottom:6px;">
            Quick Action</div>
        <div style="font-size:22px; font-weight:800; margin-bottom:4px;">
            <i class="fas fa-file-medical"></i> Create New Report</div>
        <div style="font-size:13px; opacity:0.85;">
            Select test, auto-fill parameters, generate PDF & print — all in one click</div>
    </div>
    <div style="z-index:1; background:rgba(255,255,255,0.2); padding:12px 28px; border-radius:12px;
        font-weight:700; font-size:15px; backdrop-filter:blur(4px);">
        <i class="fas fa-plus"></i> Create Report
    </div>
    <div style="position:absolute; right:-30px; top:-30px; width:150px; height:150px;
        background:rgba(255,255,255,0.08); border-radius:50%;"></div>
    <div style="position:absolute; right:60px; bottom:-40px; width:100px; height:100px;
        background:rgba(255,255,255,0.05); border-radius:50%;"></div>
</a>

<!-- Stats Grid -->
<div class="admin-stats-grid">
    <div class="admin-stat-card stat-patients">
        <div class="admin-stat-icon"><i class="fas fa-users"></i></div>
        <div class="admin-stat-info">
            <h3>{{ total_patients }}</h3>
            <p>Total Patients</p>
        </div>
    </div>
    <div class="admin-stat-card stat-tests">
        <div class="admin-stat-icon"><i class="fas fa-vial"></i></div>
        <div class="admin-stat-info">
            <h3>{{ total_tests }}</h3>
            <p>Total Tests</p>
        </div>
    </div>
    <div class="admin-stat-card stat-bookings">
        <div class="admin-stat-icon"><i class="fas fa-calendar-check"></i></div>
        <div class="admin-stat-info">
            <h3>{{ total_bookings }}</h3>
            <p>Total Bookings</p>
        </div>
    </div>
    <div class="admin-stat-card stat-pending">
        <div class="admin-stat-icon"><i class="fas fa-hourglass-half"></i></div>
        <div class="admin-stat-info">
            <h3>{{ pending_bookings }}</h3>
            <p>Pending</p>
        </div>
    </div>
    <div class="admin-stat-card stat-reports">
        <div class="admin-stat-icon"><i class="fas fa-file-pdf"></i></div>
        <div class="admin-stat-info">
            <h3>{{ total_reports }}</h3>
            <p>Reports</p>
        </div>
    </div>
    <div class="admin-stat-card stat-enquiries">
        <div class="admin-stat-icon"><i class="fas fa-envelope"></i></div>
        <div class="admin-stat-info">
            <h3>{{ unread_enquiries }}</h3>
            <p>Unread Enquiries</p>
        </div>
    </div>
    <div class="admin-stat-card" style="border-color:rgba(34,197,94,0.3)">
        <div class="admin-stat-icon" style="background:rgba(34,197,94,0.15);color:var(--admin-success)"><i class="fas fa-rupee-sign"></i></div>
        <div class="admin-stat-info">
            <h3 style="color:var(--admin-success)">₹{{ "%.0f"|format(monthly_revenue) }}</h3>
            <p>Monthly Revenue</p>
        </div>
    </div>
</div>

<!-- Quick Links -->
<div class="admin-quick-links">
    <a href="{{ url_for('admin.categories') }}" class="admin-quick-card">
        <i class="fas fa-tags"></i><span>Categories</span>
    </a>
    <a href="{{ url_for('admin.tests') }}" class="admin-quick-card">
        <i class="fas fa-vial"></i><span>Manage Tests</span>
    </a>
    <a href="{{ url_for('admin.appointments') }}" class="admin-quick-card">
        <i class="fas fa-calendar-alt"></i><span>Appointments</span>
    </a>
    <a href="{{ url_for('admin.upload_report') }}" class="admin-quick-card">
        <i class="fas fa-upload"></i><span>Upload Report</span>
    </a>
    <a href="{{ url_for('admin.users') }}" class="admin-quick-card">
        <i class="fas fa-users-cog"></i><span>Users</span>
    </a>
    <a href="{{ url_for('admin.testimonials') }}" class="admin-quick-card">
        <i class="fas fa-star"></i><span>Testimonials</span>
    </a>
    <a href="{{ url_for('admin.analytics') }}" class="admin-quick-card">
        <i class="fas fa-chart-line"></i><span>Analytics</span>
    </a>
    <a href="{{ url_for('admin.settings') }}" class="admin-quick-card">
        <i class="fas fa-cog"></i><span>Settings</span>
    </a>
</div>

<!-- Recent Bookings -->
<div class="admin-table-card">
    <div class="table-card-header">
        <h2><i class="fas fa-clock"></i> Recent Bookings</h2>
        <a href="{{ url_for('admin.appointments') }}" class="view-all-link">View All →</a>
    </div>
    {% if recent_bookings %}
    <div class="table-responsive">
        <table class="data-table">
            <thead>
                <tr>
                    <th>ID</th><th>Patient</th><th>Test</th>
                    <th>Date</th><th>Time</th><th>Status</th><th>Home</th>
                </tr>
            </thead>
            <tbody>
                {% for b in recent_bookings %}
                <tr>
                    <td>#{{ b.id }}</td>
                    <td>{{ b.user.name }}</td>
                    <td>{{ b.test.name }}</td>
                    <td>{{ b.booking_date.strftime('%d %b %Y') }}</td>
                    <td>{{ b.slot_time }}</td>
                    <td><span class="status-badge status-{{ b.status }}">{{ b.status|capitalize }}</span></td>
                    <td>{{ '✅' if b.home_collection else '—' }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div class="empty-state-sm"><p>No bookings yet.</p></div>
    {% endif %}
</div>
{% endblock %}
