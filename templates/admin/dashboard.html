{% extends 'base.html' %}
{% block title %}Admin Dashboard — Life Care Pathology Lab{% endblock %}

{% block content %}
<section class="dashboard-section admin-dashboard">
    <div class="section-container">
        <div class="dashboard-header">
            <div>
                <h1>Admin <span class="gradient-text">Dashboard</span></h1>
                <p>Overview of lab operations and statistics.</p>
            </div>
        </div>

        <!-- Stats Grid -->
        <div class="admin-stats-grid">
            <div class="admin-stat-card stat-patients">
                <div class="admin-stat-icon"><i class="fas fa-users"></i></div>
                <div class="admin-stat-info">
                    <h3>{{ total_patients }}</h3>
                    <p>Total Patients</p>
                </div>
            </div>
            <div class="admin-stat-card stat-tests">
                <div class="admin-stat-icon"><i class="fas fa-vial"></i></div>
                <div class="admin-stat-info">
                    <h3>{{ total_tests }}</h3>
                    <p>Total Tests</p>
                </div>
            </div>
            <div class="admin-stat-card stat-bookings">
                <div class="admin-stat-icon"><i class="fas fa-calendar-check"></i></div>
                <div class="admin-stat-info">
                    <h3>{{ total_bookings }}</h3>
                    <p>Total Bookings</p>
                </div>
            </div>
            <div class="admin-stat-card stat-pending">
                <div class="admin-stat-icon"><i class="fas fa-hourglass-half"></i></div>
                <div class="admin-stat-info">
                    <h3>{{ pending_bookings }}</h3>
                    <p>Pending Bookings</p>
                </div>
            </div>
            <div class="admin-stat-card stat-reports">
                <div class="admin-stat-icon"><i class="fas fa-file-pdf"></i></div>
                <div class="admin-stat-info">
                    <h3>{{ total_reports }}</h3>
                    <p>Reports Uploaded</p>
                </div>
            </div>
            <div class="admin-stat-card stat-enquiries">
                <div class="admin-stat-icon"><i class="fas fa-envelope"></i></div>
                <div class="admin-stat-info">
                    <h3>{{ unread_enquiries }}</h3>
                    <p>Unread Enquiries</p>
                </div>
            </div>
        </div>

        <!-- Quick Admin Links -->
        <div class="admin-quick-links">
            <a href="{{ url_for('admin.tests') }}" class="admin-quick-card">
                <i class="fas fa-vial"></i>
                <span>Manage Tests</span>
            </a>
            <a href="{{ url_for('admin.appointments') }}" class="admin-quick-card">
                <i class="fas fa-calendar-alt"></i>
                <span>Appointments</span>
            </a>
            <a href="{{ url_for('admin.upload_report') }}" class="admin-quick-card">
                <i class="fas fa-upload"></i>
                <span>Upload Report</span>
            </a>
            <a href="{{ url_for('admin.reports') }}" class="admin-quick-card">
                <i class="fas fa-file-pdf"></i>
                <span>All Reports</span>
            </a>
            <a href="{{ url_for('admin.patients') }}" class="admin-quick-card">
                <i class="fas fa-users"></i>
                <span>Patients</span>
            </a>
            <a href="{{ url_for('admin.enquiries') }}" class="admin-quick-card">
                <i class="fas fa-envelope"></i>
                <span>Enquiries</span>
            </a>
        </div>

        <!-- Recent Bookings -->
        <div class="dashboard-table-card">
            <div class="table-card-header">
                <h2><i class="fas fa-clock"></i> Recent Bookings</h2>
                <a href="{{ url_for('admin.appointments') }}" class="view-all-link">View All →</a>
            </div>
            {% if recent_bookings %}
            <div class="table-responsive">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Patient</th>
                            <th>Test</th>
                            <th>Date</th>
                            <th>Time</th>
                            <th>Status</th>
                            <th>Home</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for b in recent_bookings %}
                        <tr>
                            <td>#{{ b.id }}</td>
                            <td>{{ b.user.name }}</td>
                            <td>{{ b.test.name }}</td>
                            <td>{{ b.booking_date.strftime('%d %b %Y') }}</td>
                            <td>{{ b.slot_time }}</td>
                            <td><span class="status-badge status-{{ b.status }}">{{ b.status|capitalize }}</span></td>
                            <td>{{ '✅' if b.home_collection else '—' }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {% else %}
            <div class="empty-state-sm">
                <p>No bookings yet.</p>
            </div>
            {% endif %}
        </div>
    </div>
</section>
{% endblock %}
